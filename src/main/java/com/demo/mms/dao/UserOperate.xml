<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.demo.mms.dao.UserOperateMapper">
  <insert id="insertUser" parameterType="com.demo.mms.common.domain.User">
    insert into user (user_id,verify,sex,realname,email,identity,create_time,update_time)
    values   (#{user_id}, #{verify}, #{sex}, #{realname},#{email},#{identity},#{create_time},#{update_time})
  </insert>

  <insert id="insertBuyer" parameterType="com.demo.mms.common.domain.Buyer">
    insert into buyer (user_id,nickname,permission,bank_card,create_time,update_time)
    values   (#{user_id}, #{nickname}, #{permission}, #{bank_card},#{create_time},#{update_time})
  </insert>

  <insert id="insertSeller" parameterType="com.demo.mms.common.domain.Seller">
    insert into seller (user_id,nickname,permission,bank_card,create_time,update_time)
    values   (#{user_id}, #{nickname}, #{permission}, #{bank_card},#{create_time},#{update_time})
  </insert>

  <insert id="insertAdmin" parameterType="com.demo.mms.common.domain.Admin">
    insert into admin (user_id,permission,permission,create_time,update_time)
    values   (#{user_id}, #{permission}, #{note},#{create_time},#{update_time})
  </insert>

  <resultMap id="tempQueryGoodsViewed" type="com.demo.mms.common.vo.GoodsViewedQueryVO">
  </resultMap>

  <select id="queryGoodsViewedByGoods" parameterType="String" resultMap="tempQueryGoodsViewed" >
        select
          view_id,
          view_time,
          goods_viewed.goods_id as goods_id,
          goods.goods_name as goods_name,
          goods_viewed.classify_id as classify_id,
          goods_classify.classify_name as classify_name
        FROM goods_viewed,goods,goods_classify
        where buyer_id = #{buyer_id} AND
          goods_viewed.goods_id=goods.goods_id AND
          goods_viewed.classify_id=goods_classify.classify_id;
  </select>

    <select id="queryGoodsViewedByClassify" parameterType="String" resultMap="tempQueryGoodsViewed" >
        select
  view_id,
  view_time,
  goods_viewed.goods_id as goods_id,
  goods.goods_name as goods_name,
  goods_viewed.classify_id as classify_id
FROM goods_classify,(goods_viewed LEFT JOIN goods ON goods_viewed.goods_id = goods.goods_id)
where buyer_id = #{buyer_id} AND
      goods_viewed.classify_id=goods_classify.classify_id AND
      goods_classify.classify_name=#{classify_name}
  </select>
</mapper>
